dnl Process this file with autoconf to create configure.
AC_INIT(intltoolize.in)
INTLTOOL_VERSION=0.31.2

AM_INIT_AUTOMAKE(intltool, $INTLTOOL_VERSION)

dnl Put this back if we re-add doc-i18n-tool, but we need a popt check that works
dnl even if popt is not in the standard place.
dnl
dnl AC_PROG_CC
dnl AC_STDC_HEADERS
dnl AC_ARG_PROGRAM
dnl
dnl AC_CHECK_LIB(popt, poptStrippedArgv,, AC_MSG_ERROR([popt 1.5 or newer is required to build
dnl intltool. You can download the latest version from ftp://ftp.rpm.org/pub/rpm/dist/rpm-4.0.x/]))
dnl
dnl LIBXML_REQUIRED=2.2.8
dnl
dnl PKG_CHECK_MODULES(DOC_I18N_TOOL, libxml-2.0 >= $LIBXML_REQUIRED, build_xml=yes, build_xml=no)
dnl AC_SUBST(DOC_I18N_TOOL_CFLAGS)
dnl AC_SUBST(DOC_I18N_TOOL_LIBS)
dnl AM_CONDITIONAL(HAVE_LIBXML, test "x$build_xml" = "xyes")

pkgdatadir='${datadir}'"/${PACKAGE}"
AC_SUBST(pkgdatadir) dnl automake does not need this, but libtoolize does
aclocaldir='${datadir}'/aclocal
AC_SUBST(aclocaldir)

AC_PATH_PROG(PERL, perl)
if test -z "$PERL"; then
   AC_MSG_ERROR([perl not found])
fi
if test -z "`$PERL -v | fgrep 'v5.' 2> /dev/null`" -a -z "`$PERL -v | fgrep 'version 5.' 2> /dev/null`"; then
   AC_MSG_ERROR([perl 5.x required for intltool])
fi
AC_MSG_CHECKING([for XML::Parser])
if `$PERL -e "require XML::Parser" 2>/dev/null`; then
   AC_MSG_RESULT([ok])
else
   AC_MSG_ERROR([XML::Parser perl module is required for intltool])
fi

# find the actual value for $prefix that we'll end up with
# i think there's a better way to do this...
REAL_PREFIX=
if test "x$exec_prefix" = "xNONE"; then
  if test "x$prefix" = "xNONE"; then
    REAL_PREFIX=$ac_default_prefix
  else
    REAL_PREFIX=$prefix
  fi
else
  REAL_PREFIX=$exec_prefix
fi

LIBDIR_TMP="$libdir"
old_exec_prefix=$exec_prefix
exec_prefix=$REAL_PREFIX
EXPANDED_LIBDIR=`eval echo $LIBDIR_TMP`
exec_prefix=$old_exec_prefix
AC_SUBST(EXPANDED_LIBDIR)

DATADIR_TMP="$datadir"
old_exec_prefix=$exec_prefix
exec_prefix=$REAL_PREFIX
EXPANDED_DATADIR=`eval echo $DATADIR_TMP`
exec_prefix=$old_exec_prefix
AC_SUBST(EXPANDED_DATADIR)


AC_OUTPUT([
Makefile
doc/Makefile
doc-i18n-tool/Makefile
intltool-extract.in
intltool-merge.in
intltool-prepare
intltool-unicodify
intltool-update.in
intltool.spec
intltoolize
tests/Makefile
tests/cases/Makefile
tests/results/Makefile
tests/selftest.pl
xml-i18n-toolize
])
